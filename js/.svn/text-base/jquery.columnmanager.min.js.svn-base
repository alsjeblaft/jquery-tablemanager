(function(b){var a={listTargetID:null,onClass:"",offClass:"",hideInList:[],colsHidden:[],saveState:false,onToggle:null,show:function(k){d(k)},hide:function(k){c(k)}};var j=0;var g="columnManagerC";var h=function(m){var n="",l=0,k=m.cMColsVisible;if(m.cMSaveState&&m.id&&k&&b.cookie){for(;l<k.length;l++){n+=(k[l]==false)?0:1}b.cookie(g+m.id,n,{expires:9999})}};var c=function(k){(c=function(q){b(q).width("2.3%");if(b(q).is("th")){var o=b(q).text().replace(/^\s+|\s+$/g,""),s=b(q).parents("table"),l=s.attr("id"),m=l+"target",t=b("#"+m+" li:nth-child("+b(q).index()+")"),p=l+"help";if(s.data("helptext")!=1){helpdiv=b("<div class='helptext' id='"+p+"'><span class='helptext'>Click on <img src='img/collapsed.png'/> to display a hidden column again or on <img src='img/selectcol.png'/> to display or hide other columns.</span></div>");helpdiv.find("span").css("background-color",b(q).css("background-color"));prevTable=s.prev();insertTable=prevTable.find("tbody")==null?s:prevTable;helpdiv.hide().insertBefore(insertTable);helpdiv.click(function(){Id=b(this).attr("id");hdiv=b("#"+Id);if(b(hdiv).length!=0&&hdiv.prev().length!=0){prevTag=hdiv.prev().get(0).tagName;next=hdiv.next().get(0);if(prevTag=="TABLE"&&b(next).attr("class")=="helptext intro"){hdiv.remove();b(next).remove()}else{b(this).fadeTo(1500,0)}}});s.parents("div").find("div.helptext.intro").fadeTo(100,0).hide();helpdiv.fadeIn("slow")}s.data("helptext",1);t.attr("class","advoff");b(q).find("*").hide();var r=b(q).find("p.coll-plus");if(!r.length){var n=b("<p class='coll-plus'>&nbsp;</p>").click(function(){var v=b(q).index()+1;var u=b(q).parents("table");u.toggleColumns(v)})}else{r.show()}b(q).attr("title",o);b(q).append(n)}else{b(q).find("*").hide();b(q).click(function(){var v=b(q).index()+1;var u=b(q).parents("table");u.toggleColumns(v)});b(q).mouseover(function(){b(this).css("cursor","pointer")})}})(k)};var d=function(k){(d=function(q){b(q).find("*").fadeIn("fast");b(q).width("auto");b(q).removeAttr("title");if(b(q).is("th")&&b(q).find("p.coll-plus")){var o=b(q).parents("table"),n=o.attr("id"),p=n+"help",m=n+"target",l=b("#"+m+" li:nth-child("+b(q).index()+")");l.attr("class","advon");hdiv=b("#"+p);if(hdiv.length!=0&&hdiv.prev().length!=0){prevTag=hdiv.prev().get(0).tagName;next=hdiv.next().get(0);if(prevTag=="TABLE"&&b(next).attr("class")=="helptext intro"){hdiv.remove();b(next).remove()}else{b(this).fadeTo(300,0)}}b(q).find("p.coll-plus").hide()}else{b(q).unbind("click");b(q).mouseover(function(){b(this).css("cursor","")})}})(k)};var f=function(k){if(jQuery.browser.msie){return(f=function(l){return l.style.getAttribute("display")!="none"})(k)}else{return(f=function(l){return l.style.display!="none"})(k)}};var i=function(n,l,k){for(var m=0;m<l.length;m++){if(l[m].realIndex===undefined){e(n)}if(l[m].realIndex==k){return l[m]}}return null};var e=function(A){var C=A.rows;var u=C.length;var z=[];for(var s=0;s<u;s++){var B=C[s].cells;var y=B.length;for(var r=0;r<y;r++){var x=B[r];var w=x.rowSpan||1;var t=x.colSpan||1;var v=-1;if(!z[s]){z[s]=[]}var o=z[s];while(o[++v]){}x.realIndex=v;for(var q=s;q<s+w;q++){if(!z[q]){z[q]=[]}var n=z[q];for(var p=v;p<v+t;p++){n[p]=1}}}}};b.fn.columnManager=function(n){var o=b.extend({},a,n);var m=function(x){if(!o.listTargetID){return}var p=b("#"+o.listTargetID);if(!p.length){return}var w=null;if(x.tHead&&x.tHead.length){w=x.tHead.rows[0]}else{if(x.rows.length){w=x.rows[0]}else{return}}var y=w.cells;if(!y.length){return}for(cc=1,cl=y.length;cc<cl;cc++){b(y[cc]).find("*").click(function(){b(this).parents("table").toggleColumns(b(this).parents("th").index()+1)});b(y[cc]).mouseover(function(){b(this).css("cursor","pointer")})}var r=null;if(p.get(0).nodeName.toUpperCase()=="UL"){r=p}else{r=b("<ul></ul>");p.append(r)}var t=x.cMColsVisible;for(var q=0;q<y.length;q++){if(b.inArray(q+1,o.hideInList)>=0){continue}t[q]=(t[q]!==undefined)?t[q]:true;var v=b(y[q]).text(),s;if(!v.length){v=b(y[q]).html();if(!v.length){v="undefined"}}if(t[q]&&o.onClass){s=o.onClass}else{if(!t[q]&&o.offClass){s=o.offClass}}var u=b('<li class="'+s+'">'+v+"</li>").click(l);u[0].cmData={id:x.id,col:q};r.append(u)}x.cMColsVisible=t};var l=function(){var s=this.cmData;if(s&&s.id&&s.col>=0){var q=s.col,r=b("#"+s.id);if(r.length){r.toggleColumns([q+1],o);var p=r.get(0).cMColsVisible;if(o.onToggle){o.onToggle.apply(r.get(0),[q+1,p[q]])}}}};var k=function(r){var s=b.cookie(g+r);if(s){var p=s.split("");for(var q=0;q<p.length;q++){p[q]&=1}return p}return false};return this.each(function(){this.id=this.id||"jQcM0O"+j++;var s,r=[],q=[];e(this);if(o.colsHidden.length){for(s=0;s<o.colsHidden.length;s++){q[o.colsHidden[s]-1]=true;r[o.colsHidden[s]-1]=true}}if(o.saveState){var t=k(this.id);if(t&&t.length){for(s=0;s<t.length;s++){q[s]=true;r[s]=!t[s]}}this.cMSaveState=true}this.cMColsVisible=q;if(r.length){var p=[];for(s=0;s<r.length;s++){if(r[s]){p[p.length]=s+1}}if(p.length){b(this).toggleColumns(p)}}m(this)})};b.fn.toggleColumns=function(k,l){return this.each(function(){var p,q,s,y=this.rows,r=this.cMColsVisible;if(!k){return}if(k.constructor==Number){k=[k]}if(!r){r=this.cMColsVisible=[]}for(p=0;p<y.length;p++){var x=y[p].cells;for(var o=0;o<k.length;o++){var m=k[o]-1;if(m>=0){var u=i(this,x,m);if(!u){var n=m;while(n>0&&!(u=i(this,x,--n))){}if(!u){continue}}if(r[m]==undefined){r[m]=true}if(r[m]){q=l&&l.hide?l.hide:c;s=-1}else{q=l&&l.show?l.show:d;s=1}if(!u.chSpan){u.chSpan=0}if(u.colSpan>1||(s==1&&u.chSpan&&f(u))){if(u.realIndex+u.colSpan+u.chSpan-1<m){continue}u.colSpan+=s;u.chSpan+=s*-1}else{if(u.realIndex+u.chSpan<m){continue}else{q(u)}}}}}for(p=0;p<k.length;p++){this.cMColsVisible[k[p]-1]=!r[k[p]-1];if(l&&l.listTargetID&&(l.onClass||l.offClass)){var w=l.onClass,v=l.offClass,t;if(r[k[p]-1]){w=v;v=l.onClass}t=b("#"+l.listTargetID+" li").filter(function(){return this.cmData&&this.cmData.col==k[p]-1});if(w){t.removeClass(w)}if(v){t.addClass(v)}}}h(this)})};b.fn.showColumns=function(k,l){return this.each(function(){var n,o=[],m=this.cMColsVisible;if(m){if(k&&k.constructor==Number){k=[k]}for(n=0;n<m.length;n++){if(!m[n]&&(!k||b.inArray(n+1,k)>-1)){o.push(n+1)}}b(this).toggleColumns(o,l)}})};b.fn.hideColumns=function(k,l){return this.each(function(){var n,o=k,m=this.cMColsVisible;if(m){if(k.constructor==Number){k=[k]}o=[];for(n=0;n<k.length;n++){if(m[k[n]-1]||m[k[n]-1]==undefined){o.push(k[n])}}}b(this).toggleColumns(o,l)})}})(jQuery);